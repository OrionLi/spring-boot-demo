# DEMO04 Kafka

Kafka 并未提供定时消息的功能，需要我们自行拓展。

例如说[《基于 Kafka 的定时消息/任务服》](https://www.iocoder.cn/Fight/delayed-message-consume-service-use-kafka/?self)
文章，提供的方案。

当然，也可以考虑基于 MySQL 存储定时消息，Job 扫描到达时间的定时消息，发送给 Kafka 。

对于数据库处理，多线程或多机器处理会出现扩展问题。例如，一个任务记录在时间上需要执行，多个executor同时对其进行抓取执行，会导致资源浪费。这种情况非常常见。为避免此类问题，需要使用额外状态处理或者其他分库分表策略，确保每个记录尽量被一个executor操作。当某个executor执行失败时，其他executor会接手执行之前分配给它的任务。这种设计相对较为复杂。
>
注意：消息机制都是异步的，所以如果存在大量消息累积未消费，则无法保证定时消息指定的时间区间。因此，使用的时候，必须预计定时消息服务提供的服务能否满足业务的QPS要求。定时消息服务设计保证支持水平扩展，因此，可以根据业务性能需求，部署足够的服务。